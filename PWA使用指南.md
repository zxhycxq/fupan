# PWA 使用指南

## 快速开始

### 1. 启动应用

```bash
# 开发模式
pnpm dev

# 生产构建
pnpm build

# 预览生产版本
pnpm preview
```

### 2. 访问应用

开发模式：`http://localhost:5173`

### 3. 安装应用

#### 方式一：使用应用内提示（推荐）

1. 首次访问应用时，会在右下角显示安装提示卡片
2. 点击"立即安装"按钮
3. 在浏览器弹出的确认对话框中点击"安装"
4. 应用会自动添加到桌面/应用列表

#### 方式二：使用浏览器菜单

**Chrome/Edge（桌面）：**
1. 点击地址栏右侧的"安装"图标（⊕）
2. 或点击浏览器菜单（⋮）→ "安装考试成绩分析系统"
3. 确认安装

**Chrome（Android）：**
1. 点击浏览器菜单（⋮）
2. 选择"添加到主屏幕"
3. 确认添加

**Safari（iOS）：**
1. 点击分享按钮（□↑）
2. 选择"添加到主屏幕"
3. 点击"添加"

### 4. 使用已安装的应用

安装后，应用会：
- 出现在桌面/应用列表中
- 拥有独立的应用图标
- 在独立窗口中运行（无浏览器地址栏）
- 支持离线使用
- 自动检查更新

## 主要功能

### 📱 可安装
- 一键安装到设备
- 像原生应用一样使用
- 独立窗口运行

### 🚀 快速加载
- 智能缓存策略
- 秒开应用
- 流畅体验

### 📡 离线可用
- 无网络也能访问
- 已缓存的页面可用
- 数据本地存储

### 🔄 自动更新
- 后台自动检查更新
- 无感知更新
- 始终使用最新版本

## 离线功能说明

### 可离线使用的功能

✅ **模考计时器**
- 所有计时功能
- 模块设置
- 计时记录（已保存的）

✅ **已缓存的页面**
- 首页
- 工具页面
- 设置页面

✅ **本地数据**
- 计时器设置
- 模块配置
- 历史记录

### 需要网络的功能

❌ **首次访问**
- 需要网络加载资源

❌ **数据同步**
- 需要网络同步数据

❌ **外部资源**
- 未缓存的图片
- 外部链接

## 更新图标

当前使用的是占位符图标，建议替换为真实图标：

### 方法1：使用内置生成器

1. 启动应用：`pnpm dev`
2. 访问：`http://localhost:5173/generate-icons.html`
3. 点击"下载图标"按钮
4. 将下载的 `pwa-192x192.png` 和 `pwa-512x512.png` 替换到 `public/` 目录
5. 重新构建应用

### 方法2：使用在线工具

1. 访问 [RealFaviconGenerator](https://realfavicongenerator.net/)
2. 上传你的图标（建议 512x512 像素或更大）
3. 配置各平台图标
4. 下载生成的图标包
5. 将图标文件复制到 `public/` 目录

### 方法3：手动创建

使用设计工具（如 Figma、Photoshop）创建以下尺寸的图标：

- `pwa-192x192.png`：192 x 192 像素
- `pwa-512x512.png`：512 x 512 像素

**设计建议：**
- 使用品牌色作为背景
- 图标简洁清晰
- 确保在小尺寸下可辨认
- 使用 PNG 格式
- 背景不透明

## 测试 PWA

### 使用 Chrome DevTools

1. 打开应用
2. 按 F12 打开 DevTools
3. 切换到 "Application" 标签
4. 检查以下内容：

**Manifest（清单）**
- 查看应用名称、图标等配置
- 确认配置正确

**Service Workers（服务工作线程）**
- 查看 SW 状态（应该是 "activated and is running"）
- 可以手动更新或注销 SW

**Storage（存储）**
- Cache Storage：查看缓存的资源
- Local Storage：查看本地数据

### 使用 Lighthouse

1. 打开 Chrome DevTools
2. 切换到 "Lighthouse" 标签
3. 选择 "Progressive Web App"
4. 点击 "Generate report"
5. 查看评分和建议

**目标评分：**
- PWA：90+ 分
- Performance：90+ 分
- Accessibility：90+ 分
- Best Practices：90+ 分
- SEO：90+ 分

## 常见问题

### Q: 为什么看不到安装提示？

A: 可能的原因：
1. 应用已经安装
2. 浏览器不支持 PWA
3. 在过去7天内关闭过提示
4. 使用的是 Safari（需手动添加）

**解决方法：**
- 检查应用是否已安装
- 尝试使用浏览器菜单安装
- 清除浏览器数据后重试

### Q: 如何卸载应用？

A: 不同平台方法不同：

**Windows/Linux：**
1. 打开应用
2. 点击右上角菜单（⋮）
3. 选择"卸载考试成绩分析系统"

**macOS：**
1. 在应用程序文件夹中找到应用
2. 拖到废纸篓

**Android：**
1. 长按应用图标
2. 选择"卸载"

**iOS：**
1. 长按应用图标
2. 选择"删除应用"

### Q: 如何清除缓存？

A: 两种方法：

**方法1：通过 DevTools**
1. 打开 Chrome DevTools（F12）
2. Application → Storage
3. 点击 "Clear site data"

**方法2：重新安装**
1. 卸载应用
2. 清除浏览器缓存
3. 重新访问并安装

### Q: 离线时哪些功能可用？

A: 离线时可以：
- 使用模考计时器
- 查看已缓存的页面
- 访问本地保存的数据

离线时不能：
- 加载新的外部资源
- 同步数据到服务器
- 访问未缓存的页面

### Q: 如何更新应用？

A: 应用会自动更新：
1. 后台自动检查新版本
2. 发现更新后自动下载
3. 下次启动时使用新版本

**手动更新：**
1. 打开 Chrome DevTools
2. Application → Service Workers
3. 点击 "Update"

### Q: 支持哪些浏览器？

A: 浏览器支持情况：

✅ **完全支持：**
- Chrome 67+
- Edge 79+
- Firefox 44+
- Opera 54+

⚠️ **部分支持：**
- Safari 11.1+（不支持安装提示）

❌ **不支持：**
- IE 11 及更早版本

## 技术支持

如有问题，请查看：
- [PWA.md](./PWA.md) - 详细技术文档
- [Chrome DevTools](https://developer.chrome.com/docs/devtools/) - 调试工具
- [Lighthouse](https://developers.google.com/web/tools/lighthouse) - 性能测试

## 最佳实践

### 开发时
1. 使用 HTTPS 或 localhost
2. 定期测试 PWA 功能
3. 检查 Lighthouse 评分
4. 测试离线场景

### 部署时
1. 确保使用 HTTPS
2. 配置正确的缓存策略
3. 优化图标和资源
4. 测试多种设备和浏览器

### 维护时
1. 定期更新依赖
2. 监控性能指标
3. 收集用户反馈
4. 持续优化体验

## 下一步

1. ✅ 启动应用并测试
2. ✅ 安装到设备
3. ✅ 测试离线功能
4. ⬜ 替换真实图标
5. ⬜ 优化缓存策略
6. ⬜ 部署到生产环境

祝使用愉快！🎉
