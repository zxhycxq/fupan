# OCR识别测试指南

## 问题修复说明

### 修复的问题
**判断推理模块数据识别错误**

**症状**：
- 判断推理应该是：共30道，答对26道，正确率87%，用时50秒
- 但系统可能识别成了其他数据（如数量关系的15道题）

**原因**：
- 正则表达式搜索范围过大（300字符）
- 可能跨越多个模块边界
- 匹配到了错误的数据行

**解决方案**：
- 大幅缩小搜索范围（模块名后仅20字符）
- 精确匹配模块边界
- 添加数据验证逻辑

## 如何测试

### 1. 准备测试数据

使用您提供的手机截图：
- 包含完整的模块数据
- 特别关注"判断推理"模块
- 确保截图清晰可读

### 2. 上传测试

1. 打开应用的"上传成绩"页面
2. 点击"选择图片"按钮
3. 选择手机截图
4. 输入考试期数（如"2026年省考2"）
5. 输入总用时（如果有）
6. 点击"开始识别"

### 3. 查看识别结果

#### 在页面上查看
- 等待识别完成
- 查看提取的数据预览
- 特别检查"判断推理"模块的数据

#### 在控制台查看详细日志

打开浏览器开发者工具（F12），查看Console标签：

```
=== OCR识别完成 ===
识别到 XX 行文字
平均识别置信度: XX%

=== OCR文本预处理 ===
原始文本长度: XXXX
处理后文本长度: XXXX

--- 解析模块: 判断推理 ---
找到模块数据: 判断推理 共30道，答对26道，正确率87%，用时50秒
✓ 解析成功: 总题数=30, 答对=26, 正确率=87%, 用时=50秒
```

### 4. 验证数据准确性

检查以下内容：

#### 判断推理模块
- [ ] 总题数：30道 ✓
- [ ] 答对数：26道 ✓
- [ ] 正确率：87% ✓
- [ ] 用时：50秒 ✓

#### 其他模块
- [ ] 数量关系：15道题的数据正确
- [ ] 言语理解与表达：30道题的数据正确
- [ ] 资料分析：15道题的数据正确

#### 子模块
- [ ] 图形推理：10道，答对8道，80%，15秒
- [ ] 定义判断：5道，答对4道，80%，9秒
- [ ] 类比推理：数据正确
- [ ] 逻辑判断：数据正确

## 常见问题排查

### Q1: 判断推理数据还是不对

**检查步骤**：
1. 打开浏览器控制台（F12）
2. 查找"解析模块: 判断推理"的日志
3. 查看"找到模块数据"显示的内容
4. 确认匹配到的文本是否正确

**可能原因**：
- OCR识别文本本身有误
- 模块名称识别错误
- 数据格式不符合预期

**解决方法**：
- 重新拍摄更清晰的截图
- 确保模块名称完整可见
- 查看完整的OCR识别文本

### Q2: 某些模块识别不到

**检查步骤**：
1. 查看控制台日志
2. 找到"✗ 未找到模块数据"的提示
3. 查看OCR识别的完整文本

**可能原因**：
- 截图不完整
- 模块名称与预设不匹配
- OCR识别错误

**解决方法**：
- 确保截图包含完整的模块信息
- 检查模块名称是否正确
- 尝试重新上传

### Q3: 子模块数据不准确

**检查步骤**：
1. 查看"解析子模块"的日志
2. 确认匹配到的数据
3. 对比原始截图

**可能原因**：
- 子模块名称相似导致混淆
- 搜索范围设置问题
- OCR识别质量问题

**解决方法**：
- 系统已优化匹配规则
- 如果仍有问题，提供具体案例

## 调试技巧

### 查看完整OCR文本

在控制台中找到：
```
=== OCR识别完成 ===
识别结果: [完整的识别文本]
```

复制这段文本，手动检查：
- 模块名称是否正确
- 数据格式是否完整
- 是否有OCR识别错误

### 查看匹配过程

在控制台中找到每个模块的解析日志：
```
--- 解析模块: 判断推理 ---
找到模块数据: [匹配到的文本片段]
✓ 解析成功: 总题数=30, 答对=26, 正确率=87%, 用时=50秒
```

### 查看数据验证警告

如果数据异常，会显示警告：
```
警告: 判断推理 的答对数(35)大于总题数(30)，数据可能有误
```

## 优化效果对比

### 优化前
- 搜索范围：300字符
- 可能匹配到：数量关系的数据（15道题）
- 结果：判断推理显示错误数据

### 优化后
- 搜索范围：20字符
- 精确匹配：紧跟在模块名后的数据
- 结果：判断推理显示正确数据（30道题）

## 下一步

1. **测试验证**
   - 使用提供的手机截图测试
   - 验证判断推理数据是否正确
   - 检查其他模块数据

2. **反馈问题**
   - 如果仍有识别错误
   - 提供控制台日志
   - 提供原始截图

3. **持续优化**
   - 收集更多测试案例
   - 进一步优化算法
   - 提高识别准确度

## 预期结果

使用优化后的系统，手机截图应该能够准确识别：

### 一级模块（有蓝色箭头图标）
- ✓ 政治理论
- ✓ 常识判断
- ✓ 言语理解与表达
- ✓ 数量关系
- ✓ **判断推理**（共30道，答对26道，正确率87%，用时50秒）
- ✓ 资料分析

### 二级模块（子模块）
- ✓ 图形推理（10道，8道，80%，15秒）
- ✓ 定义判断（5道，4道，80%，9秒）
- ✓ 类比推理
- ✓ 逻辑判断

所有数据应该与原始截图完全一致！
