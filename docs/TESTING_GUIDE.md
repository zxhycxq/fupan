# 测试指南

## 如何测试图片识别功能

### 准备工作

1. **打开浏览器开发者工具**
   - 按 `F12` 键
   - 或右键点击页面 → 选择"检查"
   - 切换到"Console"(控制台)标签

2. **准备测试图片**
   - 确保图片清晰
   - 包含完整的考试成绩信息
   - 推荐格式: PNG
   - 推荐分辨率: 1920x1080或更高

### 测试步骤

#### 步骤1: 上传图片

1. 在系统中点击"上传图片"按钮
2. 选择准备好的考试成绩截图
3. 等待上传和识别完成

#### 步骤2: 查看OCR识别日志

在控制台中查找以下日志:

```
=== OCR识别完成 ===
识别到 XX 行文字
识别结果: ...
前200字符: ...
```

**检查要点**:
- ✅ 识别的行数是否合理
- ✅ 识别结果是否包含关键信息
- ✅ 前200字符是否清晰可读
- ✅ 是否有明显的识别错误

**常见问题**:
- 如果识别行数很少(< 10行),说明图片质量可能不好
- 如果识别结果有乱码,说明图片不清晰或格式不支持
- 如果关键信息缺失,说明截图不完整

#### 步骤3: 查看数据解析日志

在控制台中查找以下日志:

```
=== 开始解析OCR文本 ===
OCR文本长度: XXXX
OCR文本前500字符: ...
提取总分: XX.X 匹配结果: ...
提取用时: XXX 秒, 匹配结果: ...
提取最高分: XXX
提取平均分: XX.X
提取击败率: XX.X
```

**检查要点**:
- ✅ 总分是否正确(不应为0)
- ✅ 用时是否正确(不应为0)
- ✅ 匹配结果是否显示了原始文本
- ✅ 各项数据是否与图片一致

**常见问题**:
- 如果总分为0,检查"匹配结果"是否为undefined
- 如果用时为0,检查OCR文本是否包含"分"和"秒"
- 如果某项为undefined,说明OCR未识别到该信息

#### 步骤4: 查看模块解析日志

在控制台中查找以下日志:

```
=== 开始解析模块数据 ===

--- 解析模块: 政治理论 ---
找到模块数据: ...
解析结果: 总题数=XX, 答对=XX, 正确率=XX%, 用时=XX秒

  - 解析子模块: 马克思主义
  找到子模块数据: ...
  解析结果: 总题数=XX, 答对=XX, 正确率=XX%, 用时=XX秒
```

**检查要点**:
- ✅ 每个模块是否都显示"找到模块数据"
- ✅ 解析的数值是否正确
- ✅ 子模块是否都被正确解析
- ✅ 是否有"未找到模块数据"的提示

**常见问题**:
- 如果显示"未找到模块数据",说明OCR文本格式不匹配
- 如果数值不正确,检查"找到模块数据"显示的原始文本
- 如果子模块缺失,检查OCR是否识别了该部分内容

#### 步骤5: 查看解析完成日志

在控制台中查找以下日志:

```
=== 解析完成 ===
总共解析到 XX 个模块
模块列表: 政治理论, 马克思主义, ...
```

**检查要点**:
- ✅ 模块数量是否符合预期
- ✅ 模块列表是否完整
- ✅ 是否包含所有大模块和子模块

**常见问题**:
- 如果模块数量很少(< 10),说明大部分模块未能解析
- 如果某些模块缺失,需要检查OCR识别质量

### 测试场景

#### 场景1: 完整的考试成绩截图

**测试目标**: 验证系统能否正确识别和解析完整的考试成绩

**测试数据**:
- 包含总分、用时、最高分、平均分、击败率
- 包含所有大模块(政治理论、常识判断、言语理解与表达、数量关系、判断推理、资料分析)
- 包含所有子模块

**预期结果**:
- 所有基本信息都被正确提取
- 所有模块都显示"找到模块数据"
- 解析到20+个模块
- 数值与图片一致

#### 场景2: 部分截图

**测试目标**: 验证系统对不完整数据的处理

**测试数据**:
- 只包含部分模块的截图
- 或只包含总分信息的截图

**预期结果**:
- 能识别的部分正确提取
- 缺失的部分显示为undefined或0
- 不会报错或崩溃

#### 场景3: 低质量图片

**测试目标**: 验证系统对低质量图片的容错性

**测试数据**:
- 模糊的截图
- 压缩过度的图片
- 分辨率很低的图片

**预期结果**:
- OCR识别可能不准确
- 部分数据可能无法提取
- 系统应给出友好的错误提示

#### 场景4: 不同格式的截图

**测试目标**: 验证系统对不同格式的兼容性

**测试数据**:
- 不同的标点符号(中文冒号、英文冒号、空格)
- 不同的单位表示(秒、分、题、道)
- 不同的数字格式(整数、小数)

**预期结果**:
- 系统能识别多种格式
- 正确提取数据
- 自动转换单位

### 性能测试

#### 测试识别速度

1. 记录上传时间
2. 记录OCR识别完成时间
3. 记录数据解析完成时间
4. 记录总耗时

**预期性能**:
- OCR识别: 2-5秒
- 数据解析: < 1秒
- 总耗时: < 10秒

#### 测试并发处理

1. 同时上传多张图片
2. 观察系统响应
3. 检查是否有错误

**预期结果**:
- 系统能正确处理多个请求
- 不会出现数据混乱
- 每个请求独立处理

### 错误测试

#### 测试无效图片

**测试数据**:
- 非图片文件
- 损坏的图片
- 空白图片

**预期结果**:
- 显示友好的错误提示
- 不会崩溃
- 提示用户重新上传

#### 测试网络错误

**测试方法**:
1. 打开开发者工具
2. 切换到"Network"标签
3. 选择"Offline"模式
4. 尝试上传图片

**预期结果**:
- 显示网络错误提示
- 提示用户检查网络连接
- 不会卡死

#### 测试API错误

**测试方法**:
1. 修改API endpoint为无效地址
2. 尝试上传图片

**预期结果**:
- 显示API错误提示
- 记录详细的错误日志
- 提示用户联系支持

### 回归测试

每次更新后,应进行以下回归测试:

1. ✅ 上传功能正常
2. ✅ OCR识别正常
3. ✅ 数据解析正常
4. ✅ 数据存储正常
5. ✅ 数据展示正常
6. ✅ 图表渲染正常
7. ✅ 错误处理正常

### 测试报告模板

```markdown
# 测试报告

## 测试信息
- 测试日期: YYYY-MM-DD
- 测试人员: XXX
- 测试版本: vX.X.X
- 浏览器: Chrome/Firefox/Safari XX

## 测试结果

### 功能测试
- [ ] 图片上传: 通过/失败
- [ ] OCR识别: 通过/失败
- [ ] 数据解析: 通过/失败
- [ ] 数据存储: 通过/失败
- [ ] 数据展示: 通过/失败

### 性能测试
- OCR识别耗时: XX秒
- 数据解析耗时: XX秒
- 总耗时: XX秒

### 问题记录
1. 问题描述
   - 重现步骤
   - 预期结果
   - 实际结果
   - 截图/日志

## 测试结论
- 整体评价: 优秀/良好/一般/差
- 主要问题: XXX
- 改进建议: XXX
```

### 自动化测试建议

未来可以考虑添加自动化测试:

1. **单元测试**:
   - 测试数据解析函数
   - 测试正则表达式匹配
   - 测试数据转换逻辑

2. **集成测试**:
   - 测试OCR API调用
   - 测试数据库操作
   - 测试完整流程

3. **端到端测试**:
   - 使用Playwright或Cypress
   - 模拟用户操作
   - 验证最终结果

### 测试工具推荐

1. **浏览器开发者工具**: 查看日志和网络请求
2. **Postman**: 测试API接口
3. **Chrome DevTools**: 性能分析
4. **React DevTools**: 组件状态检查
5. **Redux DevTools**: 状态管理调试(如果使用)

## 总结

通过系统的测试,可以:
- ✅ 验证功能正确性
- ✅ 发现潜在问题
- ✅ 提高系统质量
- ✅ 改善用户体验
- ✅ 积累测试经验

记住:
- 📝 详细记录测试过程
- 🐛 及时报告发现的问题
- 💡 提出改进建议
- 🔄 定期进行回归测试
