# 调试指南

## 如何查看调试日志

### 1. 打开开发者工具

**Chrome/Edge**:
- 按 `F12` 键
- 或右键点击页面 → 选择"检查"
- 或按 `Ctrl+Shift+I` (Windows) / `Cmd+Option+I` (Mac)

**Firefox**:
- 按 `F12` 键
- 或右键点击页面 → 选择"检查元素"
- 或按 `Ctrl+Shift+I` (Windows) / `Cmd+Option+I` (Mac)

**Safari**:
- 首先在"偏好设置" → "高级"中启用"在菜单栏中显示开发菜单"
- 按 `Cmd+Option+I`
- 或菜单栏"开发" → "显示Web检查器"

### 2. 切换到控制台标签

在开发者工具中,点击"Console"(控制台)标签。

### 3. 上传图片并查看日志

上传考试截图后,控制台会显示详细的处理日志。

## 日志解读

### OCR识别日志

```
=== 开始解析OCR文本 ===
OCR文本长度: 1234
OCR文本前500字符: 我的得分 61.6/100 总用时 14分28秒...
```

**说明**:
- `OCR文本长度`: 识别出的文字总字符数
- `OCR文本前500字符`: 显示识别结果的前500个字符,用于检查识别质量

**检查要点**:
- 文字是否清晰完整
- 是否有乱码或识别错误
- 关键信息(总分、用时、模块名称等)是否正确

### 基本信息提取日志

```
提取总分: 61.6 匹配结果: 我的得分 61.6
提取用时: 868 秒, 匹配结果: 14分28秒
提取最高分: 100
提取平均分: 62.1
提取击败率: 48.9
```

**说明**:
- 显示从OCR文本中提取的基本考试信息
- `匹配结果`显示匹配到的原始文本

**检查要点**:
- 数值是否正确
- 如果某项为`undefined`,说明未能从文本中提取该信息

### 模块解析日志

```
=== 开始解析模块数据 ===

--- 解析模块: 政治理论 ---
找到模块数据: 政治理论 总题数20题 答对15道 正确率75% 用时28秒
解析结果: 总题数=20, 答对=15, 正确率=75%, 用时=28秒

  - 解析子模块: 马克思主义
  找到子模块数据: 马克思主义 总题数3题 答对2道 正确率67% 用时3秒
  解析结果: 总题数=3, 答对=2, 正确率=67%, 用时=3秒
```

**说明**:
- 显示每个模块和子模块的解析过程
- `找到模块数据`表示成功匹配
- `未找到模块数据`表示未能匹配

**检查要点**:
- 哪些模块成功解析
- 哪些模块未能解析
- 解析的数值是否正确

### 解析完成日志

```
=== 解析完成 ===
总共解析到 25 个模块
模块列表: 政治理论, 马克思主义, 理论与政策, ...
```

**说明**:
- 显示解析结果统计
- 列出所有成功解析的模块

**检查要点**:
- 模块数量是否符合预期
- 是否有遗漏的模块

## 常见问题诊断

### 问题1: 总分为0

**日志显示**:
```
提取总分: 0 匹配结果: undefined
```

**原因**: OCR未能识别总分信息

**解决方案**:
1. 检查OCR文本前500字符,看是否包含"我的得分"或"得分"字样
2. 确保截图包含总分信息
3. 尝试重新上传更清晰的截图

### 问题2: 用时为0

**日志显示**:
```
提取用时: 0 秒, 匹配结果: undefined
```

**原因**: OCR未能识别用时信息

**解决方案**:
1. 检查OCR文本是否包含"分"和"秒"字样
2. 确保截图包含用时信息
3. 检查用时格式是否为"XX分XX秒"

### 问题3: 某个模块未解析

**日志显示**:
```
--- 解析模块: 政治理论 ---
未找到模块数据
```

**原因**: OCR文本中该模块的格式不匹配

**解决方案**:
1. 查看OCR文本前500字符,检查该模块的文字是否正确识别
2. 检查模块名称是否完整(如"政治理论"而不是"政治")
3. 检查是否包含必要字段:
   - 总题数/共计
   - 答对/正确
   - 正确率/准确率
   - 用时/时间
4. 如果格式特殊,可能需要调整解析规则

### 问题4: 数值不准确

**日志显示**:
```
解析结果: 总题数=20, 答对=15, 正确率=75%, 用时=28秒
```
但实际应该是其他数值

**原因**: OCR识别错误或匹配到错误的数字

**解决方案**:
1. 查看"找到模块数据"显示的原始文本
2. 检查OCR是否将数字识别错误(如1识别成7)
3. 重新上传更清晰的截图
4. 确保截图中的数字清晰可读

## 提交问题报告

如果问题无法解决,请提供以下信息:

1. **完整的控制台日志**:
   - 右键点击控制台 → "保存为..."
   - 或复制所有日志文本

2. **截图**:
   - 上传的原始截图
   - 控制台日志的截图

3. **问题描述**:
   - 期望的结果
   - 实际的结果
   - 重现步骤

4. **浏览器信息**:
   - 浏览器名称和版本
   - 操作系统

## 性能优化建议

### 减少日志输出

如果不需要调试,可以在生产环境中禁用详细日志:

1. 打开 `src/services/dataParser.ts`
2. 注释掉所有 `console.log` 语句
3. 或使用条件判断:
   ```typescript
   if (import.meta.env.DEV) {
     console.log('调试信息');
   }
   ```

### 提高识别准确率

1. **使用高质量截图**:
   - 分辨率至少1920x1080
   - PNG格式优于JPG
   - 避免压缩过度

2. **确保文字清晰**:
   - 字体大小适中
   - 对比度高
   - 无模糊或失真

3. **完整截图**:
   - 包含所有必要信息
   - 不要裁剪关键部分
   - 避免遮挡或水印

## 联系支持

如果以上方法都无法解决问题:

1. 收集完整的调试信息
2. 准备问题描述和截图
3. 联系技术支持团队
4. 提供控制台日志和原始截图
